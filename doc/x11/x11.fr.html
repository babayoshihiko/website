<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Fink Documentation - Utilisation de X11 sous Darwin et Mac OS X</title></head><body>
<table width="100%" cellspacing="0">
<tr valign="bottom">
<td align="center">
Available Languages:  | 
<a href="x11.en.html">English</a> | 
Fran&ccedil;ais | 
<a href="x11.ja.html">&#26085;&#26412;&#35486; (Nihongo)</a> | 
<a href="x11.zh.html">&#20013;&#25991; (&#31616;) (Simplified Chinese)</a> | 
</td>
</tr>
</table>
<h1 style="text-align: center;">Utilisation de X11 sous Darwin et Mac OS X</h1>
    <p>
Ce document traite de l'utilisation de X11 / XFree86 / Xtools sur les systèmes Mac OS X et Darwin d'Apple.
Il commence par une introduction et l'historique du développement, puis décrit la situation actuelle et les nombreuses options d'utilisation de X11 avec ou sans Fink.
</p>
  <h2>Contents</h2><ul><li><a href="#intro"><b>1 Introduction</b></a><ul><li><a href="#intro.def-x11">1.1 Qu'est-ce que X11 ?</a></li><li><a href="#intro.def-macosx">1.2 Qu'est-ce que Mac OS X ?</a></li><li><a href="#intro.def-darwin">1.3 Qu'est-ce que Darwin ?</a></li><li><a href="#intro.def-xfree86">1.4 Qu'est-ce que XFree86 ?</a></li><li><a href="#intro.def-xtools">1.5 Qu'est-ce que Xtools ?</a></li><li><a href="#intro.client-server">1.6 Client et Serveur</a></li><li><a href="#intro.rootless">1.7 Que signifie sans racine (rootless) ?</a></li><li><a href="#intro.wm">1.8 Qu'est-ce qu'un gestionnaire de fenêtres ?</a></li><li><a href="#intro.desktop">1.9 Que sont Quartz/Aqua, Gnome et KDE ?</a></li></ul></li><li><a href="#history"><b>2 Historique</b></a><ul><li><a href="#history.early">2.1 Genèse</a></li><li><a href="#history.xonx-forms">2.2 Création de XonX</a></li><li><a href="#history.root-or-not">2.3 Être ou ne pas être racine</a></li></ul></li><li><a href="#inst-xfree86"><b>3 Getting and Installing XFree86</b></a><ul><li><a href="#inst-xfree86.fink">3.1 Installing through Fink</a></li><li><a href="#inst-xfree86.apple-binary">3.2 Apple's Binaries</a></li><li><a href="#inst-xfree86.official-binary">3.3 The Official Binaries</a></li><li><a href="#inst-xfree86.official-source">3.4 The Official Source</a></li><li><a href="#inst-xfree86.latest-cvs">3.5 The Latest Development Source</a></li><li><a href="#inst-xfree86.macgimp">3.6 MacGimp</a></li><li><a href="#inst-xfree86.switching-x11">3.7 Replacing X11</a></li><li><a href="#inst-xfree86.fink-summary">3.8 Fink package summary</a></li></ul></li><li><a href="#run-xfree86"><b>4 Starting XFree86</b></a><ul><li><a href="#run-xfree86.darwin">4.1 Darwin</a></li><li><a href="#run-xfree86.macosx-41">4.2 Mac OS X + XFree86 4.x.y</a></li><li><a href="#run-xfree86.xinitrc">4.3 The .xinitrc File</a></li></ul></li><li><a href="#xtools"><b>5 Xtools</b></a><ul><li><a href="#xtools.install">5.1 Installing Xtools</a></li><li><a href="#xtools.run">5.2 Running Xtools</a></li><li><a href="#xtools.opengl">5.3 OpenGL Notes</a></li></ul></li><li><a href="#other"><b>6 Other X11 Possibilities</b></a><ul><li><a href="#other.vnc">6.1 VNC</a></li><li><a href="#other.wiredx">6.2 WiredX</a></li><li><a href="#other.exodus">6.3 eXodus</a></li></ul></li><li><a href="#trouble"><b>7 Troubleshooting XFree86</b></a><ul><li><a href="#trouble.immedate-quit">7.1 When I launch XDarwin, it quits
or crashes almost immediately</a></li><li><a href="#trouble.black">7.2 Black icons in the GNOME panel or in the
menu of a GNOME application</a></li><li><a href="#trouble.keyboard">7.3 The keyboard doesn't work in XFree86</a></li><li><a href="#trouble.delete-key">7.4 The Backspace key doesn't work</a></li><li><a href="#trouble.locale">7.5 "Warning: locale not supported by C library"</a></li></ul></li><li><a href="#tips"><b>8 Usage Tips</b></a><ul><li><a href="#tips.terminal-app">8.1 Launching X11 apps from Terminal.app</a></li><li><a href="#tips.open">8.2 Launching Aqua apps from an xterm</a></li><li><a href="#tips.copy-n-paste">8.3 Copy and Paste</a></li></ul></li></ul><h2><a name="intro">1 Introduction</a></h2>
    
    
    <h3><a name="intro.def-x11">1.1 Qu'est-ce que X11 ?</a></h3>
      
      <p>
Le <a href="http://www.x.org/">système X Window</a> Version 11,
ou X11 en raccourci, est un système d'affichage graphique avec une architecture client-serveur transparente au réseau.
Il permet aux applications de tracer sur l'écran des pixels, des lignes, du texte, des images, etc... X11 comprend aussi des librairies supplémentaires qui permettent aux applications de tracer des éléments d'interfaces utilisateur, c'est-à-dire des boutons, des champs texte, etc...
</p>
      <p>
X11 est, de facto, le système graphique standard du monde Unix.
Il est livré avec Linux, les variantes *BSD et la plupart des variantes Unix commerciales.
Les environnements de bureaux, tels CDE, KDE et GNOME, s'exécutent sous X11.
</p>
    
    <h3><a name="intro.def-macosx">1.2 Qu'est-ce que Mac OS X ?</a></h3>
      
      <p>
        <a href="http://www.apple.com/macosx/">Mac OS X</a> est un système opératoire conçu par <a href="http://www.apple.com/">Apple Computer</a>.
Comme ses prédécesseurs NeXTStep et OpenStep, il est basé sur BSD et fait donc partie de la famille des systèmes opératoires Unix.
Néanmoins, il possède un système d'affichage graphique propriétaire.
Le moteur graphique est appelé Quartz et l'interface Aqua, bien que les deux noms soient souvent utilisés de manière interchangeable.
</p>
    
    <h3><a name="intro.def-darwin">1.3 Qu'est-ce que Darwin ?</a></h3>
      
      <p>
        <a href="http://OpenDarwin.org/">Darwin</a> est, à la base, une version réduite de Mac OS X, disponible gratuitement avec son code source.
Il ne contient ni Quartz, ni Aqua, ni aucune des technologies qui leur sont rattachées.
Par défaut, il ne fournit qu'une console texte.
</p>
    
    <h3><a name="intro.def-xfree86">1.4 Qu'est-ce que XFree86 ?</a></h3>
      
      <p>
        <a href="http://www.xfree86.org/">XFree86</a> est une implémentation open source de X11.
Au départ, elle a été développée pour tourner sous PC Intel x86, d'où son nom.
De nos jours, elle tourne sur de nombreuses architectures et systèmes opératoires, entre autres OS/2, Darwin, Mac OS X et Windows.
</p>
    
    <h3><a name="intro.def-xtools">1.5 Qu'est-ce que Xtools ?</a></h3>
      
      <p>
Xtools est un produit de  <a href="http://www.tenon.com/">Tenon Intersystems</a>.
Basée sur XFree86, c'est une version de X11 pour Mac OS X.
</p>
    
    <h3><a name="intro.client-server">1.6 Client et Serveur</a></h3>
      
      <p>
X11 possède une architecture client-serveur.
Un programme central réalise la partie graphique et coordonne l'accès des différentes applications, c'est le serveur.
Une application qui veut exécuter une fonction graphique sous X11 se connecte au serveur et lui indique ce qu'il faut dessiner.
Ces applications sont appelées clients dans le monde X11.
</p>
      <p>
Sous X11, le serveur et les clients peuvent être situés sur des machines différentes, ce qui conduit parfois à une confusion de terminologie.
Dans un environnement constitué de stations de travail et de serveurs, on exécute le serveur d'affichage X11 sur la station de travail et les applications (les clients X) sur la machine serveur.
Ainsi, lorsque l'on parle de "serveur", on entend par là le serveur d'affichage X11, et non pas la machine caché dans un placard.
</p>
    
    <h3><a name="intro.rootless">1.7 Que signifie sans racine (rootless) ?</a></h3>
      
      <p>
Contexte :
X11 modélise l'écran comme une arborescence de fenêtre contenues les unes dans les autres.
À la racine de l'arborescence se trouve une fenêtre spéciale de la taille de l'écran et qui contient toutes les autres fenêtres.
Cette fenêtre contient le fond du bureau et est appelée la "fenêtre racine".
</p>
      <p>
Maintenant, revenons à nos moutons :
comme tout environnement graphique, X11 a été écrit pour fonctionner seul et prendre le contrôle de l'écran tout entier.
Sous Mac OS X, Quartz contrôle déjà l'écran, aussi il faut prendre des dispositions pour que les deux environnements puissent fonctionner en même temps.
</p>
      <p>
Une des possibilités est de faire fonctionner les deux environnements à tour de rôle.
À chaque environnement est affecté un écran, mais seul l'un d'entre eux est visible à un moment donné, et l'utilisateur peut basculer de l'un à l'autre.
C'est ce qu'on appelle le mode plein-écran ou mode racine.
Il est appelé ainsi car il y a alors sur l'écran X11 une fenêtre racine parfaitement normale qui fonctionne exactement comme sur les autres systèmes.
</p>
      <p>
L'autre possibilité consiste à mêler les fenêtres des deux environnements.
Cela élimine la nécessité de basculer entre les deux écrans.
Cela élimine aussi la fenêtre racine de X11, car Quartz se charge déjà du fond de bureau.
Comme il n'y aucune fenêtre racine (visible), ce mode est appelé "sans racine". C'est la façon la plus agréable d'utiliser X11 sous Mac OS X.
</p>
    
    <h3><a name="intro.wm">1.8 Qu'est-ce qu'un gestionnaire de fenêtres ?</a></h3>
      
      <p>
Dans la plupart des environnements graphiques, l'aspect des cadres de fenêtres (barre de titre, bouton de fermeture, etc...) est défini par le système.
Sous X11, il en va autrement.
Dans cet environnement, les cadres de fenêtres (aussi nommés "ornements") sont fournis par un programme distinct, appelé le gestionnaire de fenêtres.
À bien des égards, le gestionnaire de fenêtres n'est autre qu'une application client ; il est lancé de la même façon et dialogue avec le serveur X au travers des mêmes canaux. 
</p>
      <p>
Vous avez le choix entre une multitude de gestionnaires de fenêtres.
Le site <a href="http://www.xwinman.org/">xwinman.org</a> en donne la liste complète.
Les plus populaires sont ceux qui permettent à l'utilisateur de personnaliser leur apparence via ce qu'on appelle des <a href="http://www.themes.org/">thèmes</a>.
La plupart des gestionnaires de fenêtres fournissent d'autres fonctionnalités, comme les menus déroulant dans la fenêtre racine, les docks et les boutons de lancement.
</p>
      <p>
De nombreux gestionnaires de fenêtres ont été compilés pour Fink ; en voici la <a href="http://fink.sourceforge.net/pdb/section.php/x11-wm/">liste actuelle</a>.
      </p>
    
    <h3><a name="intro.desktop">1.9 Que sont Quartz/Aqua, Gnome et KDE ?</a></h3>
      
      <p>
Ce sont des environnements de bureau, et il y en a bien d'autres. Leur but est de proposer un cadre aux applications, de telle sorte que leur aspect et leur comportement présentent une constante visuelle. Par exemple :
</p>
      <p>un moteur graphique : X11
</p>
      <p>un gestionnaire de fenêtre : <a href="http://sawmill.sourceforge.net/">sawfish</a>
      </p>
      <p>un bureau  : <a href="http://www.gnome.org/">Gnome</a>
      </p>
      <p>
La frontière entre moteur d'affichage graphique, gestionnaire de fenêtres et bureau est floue, car une même fonctionnalité (ou une fonctionnalité similaire) peut être implémentée par l'un de ces environnements ou plusieurs d'entre eux. C'est une des raisons pour laquelle un gestionnaire de fenêtres particulier peut ne pas fonctionner avec un environnement de bureau donné.
</p>
      <p>
De nombreuses applications sont développées pour être intégrées dans un environnement de bureau spécifique. 
Très souvent, il suffit d'installer les librairies de l'environnement de bureau (et les librairies sous-jacentes) avec lesquelles l'application a été développée pour qu'elle fonctionne (quasi) sans perte de fonctionnalités.
Par exemple, un nombre de plus en plus grand d'<a href="http://fink.sourceforge.net/pdb/section.php/gnome">applications GNOME</a> fonctionnent hors de l'environnement GNOME.
Malheureusement, <a href="http://fink.sourceforge.net/faq/usage-fink.php#kde">ce n'est pas encore le cas</a> pour les <a href="http://www.kde.org/">applications KDE</a>.
      </p>
    
  <h2><a name="history">2 Historique</a></h2>
    
    
    
      <p>[Désolée pour le langage épique, c'était trop tentant...]</p>
    
    <h3><a name="history.early">2.1 Genèse</a></h3>
      
      <p>
Au commencement était le néant.
Darwin balbutiait à peine, Mac OS X en était encore au stade embryonnaire et il n'existait aucune implémentation de X11 pour l'un et l'autre.
</p>
      <p>
Il y eut John Carmack qui porta XFree86 sur Mac OS X Server, le seul système opératoire disponible en ce temps-là dans la famille Darwin.
Puis vint Dave Zarzycki qui modifia ce port pour XFree86 4.0 et Darwin 1.0.
Les rustines trouvèrent un nid douillet dans le référentiel CVS de Darwin et s'y reposèrent en attendant les évènements.
</p>
    
    <h3><a name="history.xonx-forms">2.2 Création de XonX</a></h3>
      
      <p>
Un beau jour apparut Torrey T. Lyons et il donna aux rustines Darwin tous les soins qu'elles réclamaient.
Enfin, il les plaça dans un nouveau foyer, le référentiel CVS officiel de XFree86.
Ce fut l'ère de Mac OS X Public Beta et de Darwin 1.2.
XFree86 4.0.2 tournait bien sur Darwin, mais les utilisateurs de Mac OS X devait se déconnecter d'Aqua et ouvrir la console pour le faire tourner.
Alors Torrey prit avec lui l'<a href="http://mrcla.com/XonX/">équipe XonX</a> et commença un long voyage vers le port de XFree86 sur Mac OS X.
</p>
      <p>
À peu près à la même époque, Tenon commença à construire XTools, en se fondant sur XFree86 4.0.
</p>
    
    <h3><a name="history.root-or-not">2.3 Être ou ne pas être racine</a></h3>
      
      <p>
Bientôt l'équipe XonX réussit à faire tourner XFree86 en mode plein écran parallèlement à Quartz et mit à disposition d'utilisateurs intrépides des versions de test.
Celles-ci furent appelées XFree86-Aqua, ou XAqua en raccourci.
Comme Torrey avait pris l'initiative de tout cela, les modifications allèrent directement dans le référentiel CVS de XFree86, ce qui aboutit à la version 4.1.0.
</p>
      <p>
Dans les premiers temps, l'interface avec Quartz se faisait via une petite application appelée Xmaster.app (écrite avec Carbon, puis réécrite en Cocoa).
Plus tard, ce code fut intégré dans le serveur X, donnant naissance à XDarwin.app.
La gestion des librairies partagées fut ajoutée à cette époque (et l'on réussit à convaincre Tenon d'utiliser ce jeu de rustines au lieu du leur, afin de garantir la compatibilité binaire).
Il y eut même une certaine avancée sur un mode sans racine (avec l'API Carbon), mais hélas, il était trop tard pour l'intégrer dans XFree86 4.10.
Et la rustine sans racine vogua, sans attaches, sur le réseau.
Après la mise à disposition de XFree86 4.10 en mode en plein écran, les travaux sur le mode sans racine continuèrent, en utilisant l'API Cocoa cette fois-ci.
Un mode sans racine expérimental fut mis dans le référentiel CVS de XFree86.
 </p>
      <p>
Pendant ce temps, Apple sortait Mac OS X 10.0 et Darwin 1.3 ; quelques semaines plus tard, Tenon sortait Xtools 1.0.
</p>
      <p>Les travaux d'intégration du mode sans racine dans XFree86 continuèrent, si bien que, lorsque XFree86 4.2.0 sortit en janvier 2002, la version Darwin/Mac OS X avait été complètement intégrée dans la distribution principale de XFree86.
</p>
    
  <h2><a name="inst-xfree86">3 Getting and Installing XFree86</a></h2>
    
    
    <h3><a name="inst-xfree86.fink">3.1 Installing through Fink</a></h3>
      
      <p>
Fink will let you install X11 in any way you like,
but it also provides XFree86 packages of its own. If you
use <tt style="white-space: nowrap;">fink install ...</tt>, it will download
the source code and compile it on your computer. If
you use <tt style="white-space: nowrap;">apt-get install ...</tt> or the
<tt style="white-space: nowrap;">dselect</tt> frontend, it will download
precompiled binary packages, similar to the official
XFree86 distribution.
</p>
      <p>
The <tt style="white-space: nowrap;">xfree86-base</tt> package contains all
of XFree86 4.2.1.1 (4.2.0 for 10.1 users) except the XDarwin server.  
The <tt style="white-space: nowrap;">xfree86-rootless</tt> package is the server from the standard,
stable XFree86 4.2.1.1 release. It supports both full-screen and rootless
operation, and has OpenGL support.  
(In the early days, Fink also had an <tt style="white-space: nowrap;">xfree86-server</tt> package
which only provided fullscreen mode, but this is no longer a relevant
option.)
You also have the option to
install the server yourself; see below.  In this case, you should
only install <tt style="white-space: nowrap;">xfree86-base</tt>, or you'll risk that Fink
overwrites your manually installed server.  Note that the current stable version of<tt style="white-space: nowrap;"> xfree86-base</tt> (4.2.1.1-3) generates the <tt style="white-space: nowrap;">xfree86-rootless</tt>, <tt style="white-space: nowrap;">xfree86-base-shlibs</tt>, and <tt style="white-space: nowrap;">xfree86-rootless-shlibs</tt> during its build process.  In this case, all four packages must be installed for you to have a working XFree86 setup.
</p>
      <p>The<tt style="white-space: nowrap;"> xfree86-base-threaded</tt> and <tt style="white-space: nowrap;">xfree86-rootless-threaded</tt> packages are essentially the same thing, but have been modified to support threading, which is required by a few applications, such as <tt style="white-space: nowrap;">xine</tt>.</p>
      <p>XFree86 4.2.11 (unthreaded) is considered to be the stable, baseline XFree86 version to use with Fink on 10.2.  XFree86 4.3.0 is also available, but is considered to be more experimental, and as of this writing is only available in the unstable tree.  It has threading support built in, and is faster than 4.2.1.1 .  To install this version, you should install the <tt style="white-space: nowrap;">xfree86</tt> package.  Note that for this version, there are no longer separate -base and -rootless packages, although the libraries are splitoff into <tt style="white-space: nowrap;">xfree86-shlibs</tt>.  If you build binaries against 4.3, they may not work on 4.2.1.1 or Apple X11, so be warned.</p>
      <p>
        <b>10.3 users:</b>  You will need to install version 4.3.99.16-2 or later, which are prereleases for XFree86-4.4.  If you are working from the binary distribution, make sure to update your package descriptions (e.g. via <tt style="white-space: nowrap;">sudo apt-get update</tt>).</p>
    
    <h3><a name="inst-xfree86.apple-binary">3.2 Apple's Binaries</a></h3>
      
      <p>
On January 7, 2003, Apple released <a href="http://www.apple.com/macosx/x11/">a custom
X11 implementation based on XFree86-4.2</a> which includes Quartz rendering and accelerated
OpenGL.  A new version was released on February 10, 2003 with additional features and bugfixes.  A third release (i.e. Beta 3) was made on March 17, 2003 with further additional features and bugfixes.  This version is usable on Jaguar.
</p>
      <p>On October 24, 2003, Apple released Panther (10.3), which includes the release version of their X11 distribution.  This version is based on XFree86-4.3.</p>
      <p>
To use the Apple binaries, you need to make sure the <b>X11 User</b> package is installed, and you should also 
<a href="http://fink.sourceforge.net/doc/users-guide/upgrade.php">update</a> Fink.</p>
      <p>Under <tt style="white-space: nowrap;">fink-0.16.2</tt>, you will need to install the <b>X11 SDK</b> package, as well.  After you do this, Fink will
create a <tt style="white-space: nowrap;">system-xfree86</tt> virtual package.</p>
      <p>Under <tt style="white-space: nowrap;">fink-0.17.0</tt> and later installing the X11 SDK is only necessary if 
you want to build packages from source.  In this case, even if you don't have the SDK, there will be <tt style="white-space: nowrap;">system-xfree86</tt>
and <tt style="white-space: nowrap;">system-xfree86-shlibs</tt> virtual packages, the latter representing the shared libraries.  If you do install the SDK, there will also be a  
<tt style="white-space: nowrap;">system-xfree86-dev</tt> package, representing the headers.
</p>
      <p>
If you have an existing XFree86 distribution installed, be it through Fink or otherwise, you
can follow the <a href="#inst-xfree86.switching-x11">instructions on
replacing one X11 package with another</a>.  Make sure that you remove your existing
packages, then install Apple's X11 (and X11 SDK, if needed or desired).
</p>
      <p>
Some notes on using Apple's X11:
</p>
      <ul>
        <li>
          <p>The <tt style="white-space: nowrap;">autocutsel</tt> package is no longer needed.  If you're starting
  X11 with it enabled, you should disable it.</p>
        </li>
        <li>
          <p>Apple's X11 uses your existing <tt style="white-space: nowrap;">~/.xinitrc</tt> file.  If you want the
  full effect of Quartz integration, you should use <tt style="white-space: nowrap;">/usr/X11R6/bin/quartz-wm</tt>
  as your window manager, or delete your <tt style="white-space: nowrap;">~/.xinitrc</tt> completely.</p>
          <p>If you just want cut-and-paste integration, but want to use a different window manager, you can do 
this as in the following example:</p>
          <pre>/usr/X11R6/bin/quartz-wm --only-proxy &amp;
exec /sw/bin/fvwm2</pre>
          <p>You may, of course, call any other window manager, <tt style="white-space: nowrap;">startkde</tt>, etc.</p>
        </li>
        <li>
          <p>
            <tt style="white-space: nowrap;">quartz-wm</tt> doesn't fully support Gnome/KDE window manager hints, so
  you may see some strange behavior on windows that shouldn't have decorations, but do.</p>
        </li>
        <li>
          <p>Apple X11 doesn't honor the Fink environment settings by default.  In order to call up startup applications 
that you have installed with fink (e.g. window managers, gnome-session, other apps under 
<tt style="white-space: nowrap;">/sw/bin</tt>) put the following near the top of <tt style="white-space: nowrap;">~/.xinitrc</tt> (i.e. after the 
initial "<tt style="white-space: nowrap;">#!/bin/sh</tt>", but before you run any programs):</p>
          <pre> . /sw/bin/init.sh
</pre>
          <p>so that the Fink environment is initialized.  Note:  <tt style="white-space: nowrap;">init.sh</tt> is used rather than <tt style="white-space: nowrap;">init.csh</tt> because <tt style="white-space: nowrap;">.xinitrc</tt> is run by <tt style="white-space: nowrap;">sh</tt> rather than <tt style="white-space: nowrap;">tcsh</tt>.</p>
        </li>
        <li>
          <p>Applications that require calling other programs which reside within your Fink tree for some of their functions need special treatment to get them to work when called from the Application menu.  Instead of putting just the full path to the filename, e.g.</p>
          <pre>/sw/bin/emacs</pre>
          <p>you'll want to use something like the following, if you're using bash as your
default shell:</p>
          <pre>. /sw/bin/init.sh ; emacs</pre>
          <p>and if you're using tcsh:</p>
          <pre>source /sw/bin/init.csh ; emacs</pre>
          <p>This makes sure that the application has the correct PATH information.  You can use this syntax for any Fink-installed application.</p>
        </li>
        <li>
          <p>If you are trying to build a package by hand against Apple's X11 and you see a failure like:</p>
          <pre>ld: err.o illegal reference to symbol: _XSetIOErrorHandler 
defined in indirectly referenced dynamic library 
/usr/X11R6/lib/libX11.6.dylib</pre>
          <p>then you'll need to make sure to that <tt style="white-space: nowrap;">-lX11</tt> is present during linking.  Check your package's configuration options to see how to feed it the extra argument.</p>
        </li>
        <li>
          <p>If you use the <tt style="white-space: nowrap;">xfree86</tt> package, and later switch to Apple's X11 (on either 10.2.x or 10.3.x), any
packages you have built against <tt style="white-space: nowrap;">xfree86</tt> will need to be rebuilt, as the binaries are incompatible.</p>
        </li>
      </ul>
    
    <h3><a name="inst-xfree86.official-binary">3.3 The Official Binaries</a></h3>
      
      <p>
The XFree86 project has an official binary distribution of XFree86
4.2.0, which can be upgraded to 4.2.1.1 with patches.
You can find it on your local <a href="http://www.xfree86.org/MIRRORS.shtml">XFree86 mirror</a> in
the directory <tt style="white-space: nowrap;">4.2.0/binaries/Darwin-ppc-5.x</tt>.
Be sure to get the <tt style="white-space: nowrap;">Xprog.tgz</tt> and <tt style="white-space: nowrap;">Xquartz.tgz</tt>
tarballs even though they are marked as optional.
If you're unsure what you need, just download the whole directory.
Run the <tt style="white-space: nowrap;">Xinstall.sh</tt> script as root to install the stuff.
(You might want to read the <a href="http://www.xfree86.org/4.2.0/Install.html">official
instructions</a> before installing.)   If you prefer, you can use the <a href="http://prdownloads.sourceforge.net/xonx/XInstall_10.1.sit?download">binary</a> from XonX, which uses identical source but is easier to use.  In either case, download, unzip and run the following upgrades:</p>
      <ol>
        <li>10.1 users: <a href="http://prdownloads.sourceforge.net/xonx/XFree86_4.2.0.1-10.1.zip?download">4.2.0 -&gt; 4.2.0.1 upgrade</a>.  10.2 users:  <a href="http://prdownloads.sourceforge.net/xonx/XFree86_4.2.0.1-10.2.zip?download">4.2.0 -&gt; 4.2.0.1 upgrade</a>
        </li>
        <li>10.1 and 10.2 users:  <a href="http://prdownloads.sourceforge.net/xonx/XFree86_4.2.1.1.zip?download">4.2.0.1 -&gt; 4.2.1.1 upgrade</a>
        </li>
      </ol>
      <p>There is an official binary distribution of XFree86
4.3.0, as well, on the<a href="http://www.xfree86.org/MIRRORS.shtml">XFree86 mirrors</a> in
the directory <tt style="white-space: nowrap;">4.3.0/binaries/Darwin-ppc-6.x</tt>.
Be sure to get the <tt style="white-space: nowrap;">Xprog.tgz</tt> and <tt style="white-space: nowrap;">Xquartz.tgz</tt>
tarballs even though they are marked as optional.
If you're unsure what you need, just download the whole directory.
Run the <tt style="white-space: nowrap;">Xinstall.sh</tt> script as root to install the stuff.
(You might want to read the <a href="http://www.xfree86.org/4.3.0/Install.html">official
instructions</a> before installing.)</p>
      <p>Whichever version you install, you've now got XFree86 with a server that can do fullscreen, or 
rootless under Mac OS X.
</p>
    
    <h3><a name="inst-xfree86.official-source">3.4 The Official Source</a></h3>
      
      <p>
If you've got the time to spare, you can build XFree86 4.2.0 from
source.
You can find the source on you local <a href="http://www.xfree86.org/MIRRORS.shtml">XFree86 mirror</a> in
the directory <tt style="white-space: nowrap;">4.2.0/source</tt>.
Grab all three <tt style="white-space: nowrap;">X420src-#.tgz</tt> tarballs and extract them in
the same directory.
You can customize the build by putting macro definitions in the file
<tt style="white-space: nowrap;">config/cf/host.def</tt> in the XFree86 source tree.

See
<tt style="white-space: nowrap;">config/cf/darwin.cf</tt> for some hints.
(Note: Only the macros that have an #ifndef check around them can be
overwritten in host.def.)
</p>
      <p>
When you're happy with your configuration, compile and install XFree86
with the following commands:
</p>
      <pre>make World
sudo make install install.man</pre>
      <p>To update to 4.2.1.1, follow the instructions in the <a href="#inst-xfree86.official-binary">Official Binaries</a> section.</p>
      <p>To install 4.3.0, follow the above instructions, replacing "2" with "3", but don't do the 4.2.1.1 update procedure.</p>
      <p>
As with the official binaries, you've now got XFree86 with a server
that can do fullscreen, or rootless under Mac OS X.
</p>
    
    <h3><a name="inst-xfree86.latest-cvs">3.5 The Latest Development Source</a></h3>
      
      <p>
If you have not only time, but also some nerves to spare you can get
the latest development version of XFree86 from the public CVS
repository.
Note that the code is under constant development; what you get today
is usually not the same as what you got yesterday.
</p>
      <p>
To install, follow the <a href="http://www.xfree86.org/cvs/">XFree86
CVS</a> instructions to download the <tt style="white-space: nowrap;">xc</tt> module.
Then, follow the source build instructions above.
</p>
    
    <h3><a name="inst-xfree86.macgimp">3.6 MacGimp</a></h3>
      
      <p>
The downloadable installer which was offered by the MacGimp people 
during 2001
did not contain XFree86.
(It would overwrite some XFree86 configuration files, though.)
</p>
      <p>
The CD that <a href="http://www.macgimp.com/">MacGimp, Inc.</a>
offers for sale reportedly contains XFree86.
It's not quite clear what version it is; it may be a mix of
4.0.3, 4.1.0 and a development snapshot.
The server does rootless mode, using a patch from the time before
4.1.0.
</p>
    
    <h3><a name="inst-xfree86.switching-x11">3.7 Replacing X11</a></h3>
      
      <p>
If you have already installed one of the Fink X11 packages but for one reason or another
have decided you need to remove one and replace it with another, the procedure is pretty
straightforward.  You will have to force a removal of the old packages, and then install the
new, to keep your dpkg database consistent.
</p>
      <p>
There are two different ways to do this:
</p>
      <ol>
        <li>
          <p>Use FinkCommander</p>
          <p>
   If you are using <a href="http://finkcommander.sourceforge.net/">FinkCommander</a>, you
   can force removal through the menu.  For example, if you have
   <tt style="white-space: nowrap;">xfree86-rootless</tt> installed, but want the threaded version, you
   can select your <tt style="white-space: nowrap;">xfree86-rootless</tt>,
   <tt style="white-space: nowrap;">xfree86-rootless-shlibs</tt>, <tt style="white-space: nowrap;">xfree86-base</tt>, and
   <tt style="white-space: nowrap;">xfree86-base-shlibs</tt> packages, and then run:
  </p>
          <pre>Source -&gt; Force Remove</pre>
        </li>
        <li>
          <p>Manually Remove from the Command-Line</p>
          <p>
   To manually, remove them, you use the <tt style="white-space: nowrap;">dpkg</tt> with the --force-depends
   option, like so:
  </p>
          <pre>sudo dpkg -r --force-depends xfree86-rootless\ 
xfree86-rootless-shlibs xfree86-base xfree86-base-shlibs</pre>
          <p>
   Note that if you have apps that require threaded XFree86, you may have trouble with your
   dpkg database if you force remove it and install a different XFree86 package or placeholder
   package.
  </p>
        </li>
      </ol>
      <p>If, on the other hand, you have an X11 version that was not installed via Fink, you'll need to remove it via the command line:</p>
      <pre>sudo rm -rf /usr/X11R6 /etc/X11</pre>
      <p>The above holds true for removing any flavor of X11 that you didn't install through Fink.  You will also need to remove <tt style="white-space: nowrap;">XDarwin.app</tt> | 
<tt style="white-space: nowrap;">X11.app</tt>, depending on what you had installed.  Make sure to check your <tt style="white-space: nowrap;">.xinitrc</tt> if you are removing Apple's X11 to 
make sure that you aren't trying to run <tt style="white-space: nowrap;">quartz-wm</tt>.  You can now install whatever new X11 variety you want, manually or via Fink.</p>
    
    <h3><a name="inst-xfree86.fink-summary">3.8 Fink package summary</a></h3>
      
      <p>
A quick summary of the install options and the Fink packages you
should install:
</p>
      <table border="0" cellpadding="0" cellspacing="10"><tr valign="bottom"><th align="left">Install Type</th><th align="left">Fink packages</th></tr><tr valign="top"><td>4.2.x built via Fink</td><td>
            <p>
              <tt style="white-space: nowrap;">xfree86-base</tt> and <tt style="white-space: nowrap;">xfree86-rootless</tt> (and their <tt style="white-space: nowrap;">-shlibs</tt>)</p>
            <p>or <tt style="white-space: nowrap;">xfree86-base-threaded</tt> and <tt style="white-space: nowrap;">xfree86-rootless-threaded</tt> (and <tt style="white-space: nowrap;">-shlibs</tt>)</p>
          </td></tr><tr valign="top"><td>4.3.x built via Fink</td><td>
            <p>
              <tt style="white-space: nowrap;">xfree86</tt> and <tt style="white-space: nowrap;">xfree86-shlibs</tt>
            </p>
          </td></tr><tr valign="top"><td>4.x official binaries</td><td>
            <p>
              <tt style="white-space: nowrap;">system-xfree86</tt> only (+splitoffs)</p>
          </td></tr><tr valign="top"><td>4.x built from source, or from the latest CVS source</td><td>
            <p>
              <tt style="white-space: nowrap;">system-xfree86</tt> only (+splitoffs)</p>
          </td></tr><tr valign="top"><td>4.2.x from Apple</td><td>
            <p>
              <tt style="white-space: nowrap;">system-xfree86</tt> only (+splitoffs)
</p>
          </td></tr><tr valign="top"><td>4.3.x from Apple</td><td>
            <p>
              <tt style="white-space: nowrap;">system-xfree86</tt> only (+splitoffs)
</p>
          </td></tr></table>
    
  <h2><a name="run-xfree86">4 Starting XFree86</a></h2>
    
    
    <h3><a name="run-xfree86.darwin">4.1 Darwin</a></h3>
      
      <p>
On pure Darwin, XFree86 behaves like on any other Unix.
The usual way to start it is via <tt style="white-space: nowrap;">startx</tt> from the console;
that starts both the server and some initial clients like the window
manager and a terminal emulator with a shell.
On pure Darwin it is not necessary to specify any parameters, so you
can just type:
</p>
      <pre>startx</pre>
      <p>
You can customize what is started through several files in your home
directory.
<tt style="white-space: nowrap;">.xinitrc</tt> controls what clients get started.
<tt style="white-space: nowrap;">.xserverrc</tt> controls server options and may even
start a different server.
If you're having trouble (as in, you only get a blank screen or
XFree86 drops you right back to the console), you can start
troubleshooting by moving these files out of the way.
When <tt style="white-space: nowrap;">startx</tt> doesn't find these files, it will use safe
defaults that should always work.
</p>
      <p>
Alternatively, you can start the server directly with one of the XDMCP
options, like this:
</p>
      <pre>X -query remotehost</pre>
      <p>
Details about this can be found in the <tt style="white-space: nowrap;">Xserver</tt> manual
page.
</p>
      <p>
Finally, there is the option to set up <tt style="white-space: nowrap;">xdm</tt>; read its
manual page for details.
</p>
      <p>
Note: If you're running Mac OS X, you can type <tt style="white-space: nowrap;">&gt;console</tt>
at the login window and you'll get a text console that is
equivalent to pure Darwin.
You can use all of the start methods outlined above, with the
exception of <tt style="white-space: nowrap;">xdm</tt>.
</p>
    
    <h3><a name="run-xfree86.macosx-41">4.2 Mac OS X + XFree86 4.x.y</a></h3>
      
      <p>
There are basically two ways to start XFree86 under Mac OS X.
One is double-clicking the XDarwin.app application in your
Applications folder.  This will let you choose between full 
screen and rootless mode in a dialog at startup, just 
double-click the XDarwin.app application. You can disable 
the dialog and set XDarwin to always use the mode of your 
choice in the Preferences dialog.  
</p>
      <p>
Prior to 4.2.0 it would fire up fullscreen mode automatically, 
and there was no way to get rootless mode by double-clicking 
the application.
</p>
      <p>
The other way to start XFree86 under Mac OS X is via
<tt style="white-space: nowrap;">startx</tt> from Terminal.app.
If you start the server this way, you must tell it that it should run
in parallel with Quartz.
You do this by passing the <tt style="white-space: nowrap;">-fullscreen</tt> option, like this:
</p>
      <pre>startx -- -fullscreen</pre>
      <p>
That will start up the server in fullscreen mode, 
plus the clients in your <tt style="white-space: nowrap;">.xinitrc</tt>.  
</p>
      <p>
NOTE: prior to 4.2, <tt style="white-space: nowrap;">-quartz</tt> was used for fullscreen mode.
</p>
      <p>
If the server you have supports rootless operation, 
you can start it in rootless mode with the 
<tt style="white-space: nowrap;">-rootless</tt> option:</p>
      <pre>startx -- -rootless</pre>
      <p>
The <tt style="white-space: nowrap;">-quartz</tt> option no longer selects fullscreen mode,
but rather uses the default mode set in the preferences.
</p>
      <p>As of 4.3, if you use <tt style="white-space: nowrap;">startx</tt> without arguments, the startup dialog box will come up.</p>
    
    <h3><a name="run-xfree86.xinitrc">4.3 The .xinitrc File</a></h3>
      
      <p>
If a file named <tt style="white-space: nowrap;">.xinitrc</tt> exists in your home
directory, it will be used to start some initial X clients, e.g. the
window manager and some xterms or a desktop environment like GNOME.
The <tt style="white-space: nowrap;">.xinitrc</tt> file is a shell script that contains
the commands to do this.
It is <b>not</b> necessary to put the usual <tt style="white-space: nowrap;">#!/bin/sh</tt>
in the first line and to set the executable bit on the file;
xinit will still know how to run it through a shell.
</p>
      <p>
When there is no <tt style="white-space: nowrap;">.xinitrc</tt> file in your home
directory, XFree86 will use its default file,
<tt style="white-space: nowrap;">/private/etc/X11/xinit/xinitrc</tt>.
You can use the default file as a starting point for your own
.xinitrc:
</p>
      <pre>cp /private/etc/X11/xinit/xinitrc ~/.xinitrc</pre>
      <p>
If you're using Fink, you should source <tt style="white-space: nowrap;">init.sh</tt>
right at the beginning to make sure the environment is set up correctly.
</p>
      <p>
You can put fairly arbitrary commands in an <tt style="white-space: nowrap;">.xinitrc</tt>,
but there are some caveats.
First, the shell that interprets the file will by default wait for
every program to finish before it starts the next one.
If you want several programs to run in parallel, you must tell the
shell to put them "in the background" by adding a <tt style="white-space: nowrap;">&amp;</tt> at
the end of the line.
</p>
      <p>
Second, <tt style="white-space: nowrap;">xinit</tt> waits for the <tt style="white-space: nowrap;">.xinitrc</tt>
script to finish and interprets that as "the session has ended, I should
kill the X server now, too".
This means that the last command of your <tt style="white-space: nowrap;">.xinitrc</tt>
must not be run in the background and it should be a long-living program.
Customarily, the window manager is used for this purpose.
In fact, most window managers assume that <tt style="white-space: nowrap;">xinit</tt> is
waiting for them to finish and use this to make the "Log out" entry in
their menus work.
(Note: To save some memory and CPU cycles, you can put an
<tt style="white-space: nowrap;">exec</tt> before the last line like in the examples below.)
</p>
      <p>
A simple example that starts up GNOME:
</p>
      <pre>source /sw/bin/init.sh
exec gnome-session</pre>
      <p>
A more complex example that turns the X11 bell off, starts some clients
and finally executes the Enlightenment window manager:
</p>
      <pre>source /sw/bin/init.sh

xset b off

xclock -geometry -0+0 &amp;
xterm &amp;
xterm &amp;

exec enlightenment</pre>
    
  <h2><a name="xtools">5 Xtools</a></h2>
    
    
    <h3><a name="xtools.install">5.1 Installing Xtools</a></h3>
      
      <p>
Now that's easy for a change.
Get the installer, double-click it, and follow the instructions.
Be sure to select the startup volume when asked.
</p>
      <p>
If you're using Fink, you should install the
<tt style="white-space: nowrap;">system-xtools</tt> package after you've installed Xtools.
That package will not install any files, it will just check that the
libraries etc. are there and act as a placeholder in Fink's dependency
system.
</p>
    
    <h3><a name="xtools.run">5.2 Running Xtools</a></h3>
      
      <p>
To run Xtools, double-click Xtools.app in your Applications folder.
Like XFree86, Xtools will run the clients you specify in your
<tt style="white-space: nowrap;">.xinitrc</tt> file.
Xtools additionally allows you to start clients via the menu.
</p>
    
    <h3><a name="xtools.opengl">5.3 OpenGL Notes</a></h3>
      
      <p>
Xtools does hardware-accelerated OpenGL in rootless mode and comes
with the libraries to support it.
While the main libGL library is fine, the libGLU and libglut libraries
are only present as static libraries, which is not sufficient for
full binary compatibility with XFree86.
Also, some headers are missing.
Fink doesn't offer a workaround at this time.
Hopefully this will be fixed in Xtools 1.1 once it is released.
</p>
    
  <h2><a name="other">6 Other X11 Possibilities</a></h2>
    
    
    <h3><a name="other.vnc">6.1 VNC</a></h3>
      
      <p>
VNC is a network-capable graphics display system similar in design to
X11.
However, it works at a lower level, making implementation easier.
With the Xvnc server and a Mac OS X display client, it is possible to
run X11 applications with Mac OS X.
Jeff Whitaker's <a href="http://www.cdc.noaa.gov/~jsw/macosx_xvnc/">Xvnc page</a> has
more information on that.
</p>
    
    <h3><a name="other.wiredx">6.2 WiredX</a></h3>
      
      <p>
        <a href="http://www.jcraft.com/wiredx/">WiredX</a> is an X11
server written in Java.
It also supports rootless mode.
An Installer.app package is available at the web site.
</p>
    
    <h3><a name="other.exodus">6.3 eXodus</a></h3>
      
      <p>
According to the website, <a href="http://www.powerlan-usa.com/exodus/">eXodus 8</a> by Powerlan
USA runs natively on Mac OS X.
It is unknown what codebase it uses and whether/how it supports local
clients.
Because of this, there is no special support for eXodus in Fink.
If you have more info, please throw it our way.
</p>
    
  <h2><a name="trouble">7 Troubleshooting XFree86</a></h2>
    
    
    <h3><a name="trouble.immedate-quit">7.1 When I launch XDarwin, it quits
or crashes almost immediately</a></h3>
      
      <p>
First of all: Don't Panic!
There are lots of things than can go wrong with XFree86, and a good
number of them can cause startup failures.
Further, it is not unusual that XDarwin crashes when it experiences
startup problems.
This section tries to provide a comprehensive list of problems you may
come across.
But first, you need to gather two important pieces of information:
</p>
      <p>
        <b>XDarwin version.</b>
You can find the XDarwin version in the Finder by clicking
<b>once</b> on the XDarwin icon and then selecting "Show Info"
from the menu.
The version is only incremented when a new binary test release is made
by the XonX project, so "1.0a1" may actually be any version between
1.0a1 and 1.0a2.
</p>
      <p>
        <b>Error messages.</b>
These are essential in pinpointing the particular problem you
experience.
How you get the error messages depends on how you started XDarwin.
If you ran <tt style="white-space: nowrap;">startx</tt> from a Terminal window, you'll have the
messages right there in that window.
Remember that you can scroll up.
If you started XDarwin by double-clicking the icon, the messages end
up in the system log, which you can access through the Console
application in the Utilities folder.
Be sure to pick the right set of messages, i.e. the last one.
</p>
      <p>
We'll start with a list of the messages you may see:
</p>
      <pre>_XSERVTransmkdir: Owner of /tmp/.X11-unix should be set to root</pre>
      <pre>_IceTransmkdir: Owner of /tmp/.ICE-unix should be set to root</pre>
      <p>
Class: Harmless.
X11 creates hidden directories in /tmp to store the socket "files" for
local connections.
For security reasons, X11 prefers if these directories are owned by
root, but since they are world-writable anyway it will still run
without any problems.
(Note: It's quite hard to have these dirs owned by root, as Mac OS X
wipes out /tmp on reboots and XDarwin doesn't run with root privileges
and doesn't need to.)
</p>
      <pre>QuartzAudioInit: AddIOProc returned 1852797029</pre>
      <pre>-[NSCFArray objectAtIndex:]: index (2) beyond bounds (2)</pre>
      <pre>kCGErrorIllegalArgument : CGSGetDisplayBounds (display 35434400)</pre>
      <pre>No core keyboard</pre>
      <p>
Class: Bogus.
These are follow-up errors that result when the server tries to reset
itself after a previous error.
During that, another copy of the startup banner is printed, followed
by one or more of the above messages because resetting the server
doesn't really work in the affected versions of XDarwin.
So when you see messages like these, scroll up in the Terminal
resp. Console window and look for another set of banner and messages.
This affects all versions up to and including XDarwin 1.0a3; it was
fixed after 1.0a3 was released.
</p>
      <pre>cat: /Users/chrisp/.Xauthority: No such file or directory</pre>
      <p>
Class: Mostly harmless.
It is unknown where these messages come from and they seem to have no
impact on operations.
You can get rid of them by running <tt style="white-space: nowrap;">touch .Xauthority</tt> in
your home directory.
</p>
      <pre>Gdk-WARNING **: locale not supported by C library</pre>
      <p>
Class: Harmless.
This just means what it says and won't keep the application from
working.
For more information, <a href="#trouble.locale">see below</a>.
</p>
      <pre>Gdk-WARNING **: locale not supported by Xlib, locale set to C
Gdk-WARNING **: can not set locale modifiers</pre>
      <p>
Class: Bad, but not fatal.
These messages may appear in addition to the one above.
This indicates that XFree86's locale data files are not present.
It appears that this happens unreproducibly when building Free86 from
source.
Most applications will still work, GNU Emacs is a notable exception.
</p>
      <pre>Unable to open keymapping file USA.keymapping.
Reverting to kernel keymapping.</pre>
      <p>
Class: Often fatal.
This can happen with XDarwin 1.0a1, with the "Load from file"
keymapping option enabled.
That version needs a full path when the file to load is set via the
Preferences dialog, but searches automatically when it is passed on
the command line.
The message will usually be followed by the "assert" message shown
below.
To fix this, follow the directions below.
</p>
      <pre>Fatal server error:
assert failed on line 454 of darwinKeyboard.c!</pre>
      <pre>Fatal server error:
Could not get kernel keymapping! Load keymapping from file instead.</pre>
      <p>
Class: Fatal.
Changes Apple made in Mac OS X 10.1 broke the code in XFree86 that
reads the keyboard layout from the operating system kernel;
the message above is the result of that.
You must use the "Load from file" keymapping option on Mac OS X 10.1.
The setting is in the XDarwin Preferences dialog.
Be sure that a file is selected (i.e. use the "Pick file" button) -
simply activating the check box may not be sufficient with some
versions of XDarwin.
If you can't get to the Preferences dialog because XDarwin closes
before you get a chance, run it from Terminal with the command
<tt style="white-space: nowrap;">startx -- -quartz -keymap USA.keymapping</tt>.
This usually allows XDarwin to start up, and you can then make the
permanent choice in the Preferences dialog.
</p>
      <pre>Fatal server error:
Could not find keymapping file .</pre>
      <p>Class: Fatal (as it says).  This error is due to the absence of the keymapping files under Panther.  You need to install <tt style="white-space: nowrap;">xfree86-4.3.99-16</tt> or later, since these versions don't need the keymapping files.</p>
      <pre>Warning: no access to tty (Inappropriate ioctl for device).
Thus no job control in this shell.</pre>
      <p>
Class: Mostly harmless.
XDarwin 1.0a2 and later launch an interactive shell behind the scenes
to run your client startup file (.xinitrc).
This was done so that you don't have to add statements to set up PATH
in that file.
Some shells complain that they're not connected to a real terminal,
but that can be ignored since that shell instance is not used for
anything that requires job control or the like.
</p>
      <pre>Fatal server error:
failed to connect as window server!</pre>
      <p>
Class: Fatal.
This means that the console-mode server (for pure Darwin) got started
while you were logged into Aqua.
Usually this happens when you installed the official XFree86 binary
distribution and left out the Xquartz.tgz tarball.
It can also happen when the symlinks in /usr/X11R6/bin are messed up
or when you issue the command <tt style="white-space: nowrap;">XDarwin</tt> in a Terminal
window to start the server (you should use startx instead in that
case, see <a href="#run-xfree86">Starting XFree86</a>).
</p>
      <p>
In any case, you can run <tt style="white-space: nowrap;">ls -l /usr/X11R6/bin/X*</tt> and
check the output.
You should see four relevant entries:
<tt style="white-space: nowrap;">X</tt>, a symlink pointing at <tt style="white-space: nowrap;">XDarwinStartup</tt>;
<tt style="white-space: nowrap;">XDarwin</tt>, an executable file (this is the console
mode server);
<tt style="white-space: nowrap;">XDarwinQuartz</tt>, a symlink pointing at
<tt style="white-space: nowrap;">/Applications/XDarwin.app/Contents/MacOS/XDarwin</tt>;
and <tt style="white-space: nowrap;">XDarwinStartup</tt>, a small executable file.
If any of these are missing or pointing at different files, you need
to fix that.
How you do that depends on the method you used to install XFree86.
See the <a href="#inst-xfree86.rootless">Roaming
Rootless Servers</a> section for more hints.
</p>
      <pre>The XKEYBOARD keymap compiler (xkbcomp) reports:
&gt; Error:            Can't find file "unknown" for geometry include
&gt;                   Exiting
&gt;                   Abandoning geometry file "(null)"
Errors from xkbcomp are not fatal to the X server</pre>
      <p>
Class: Mostly harmless.
As the message says, it is not fatal.
To my knowledge, XDarwin doesn't use the XKB extension at all.
Probably some client program tries to use it anyway...
</p>
      <pre>startx: Command not found.</pre>
      <p>
Class: Fatal.
This can happen with XDarwin 1.0a2 and 1.0a3 when your shell
initialization files are not set up to add /usr/X11R6/bin to the PATH
variable.
If you use Fink and haven't changed your default shell, adding the
line <tt style="white-space: nowrap;">source /sw/bin/init.csh</tt> to <tt style="white-space: nowrap;">.cshrc</tt>
in your home directory (as recommended by the Fink instructions) should
be sufficient.
</p>
      <pre>_XSERVTransSocketUNIXCreateListener: ...SocketCreateListener() failed
_XSERVTransMakeAllCOTSServerListeners: server already running</pre>
      <pre>Fatal server error:
Cannot establish any listening sockets - Make sure an X server isn't already
running</pre>
      <p>
Class: Fatal.
This can happen when you accidentally run several instances of XDarwin
at once,
or maybe after an unclean shutdown (i.e. crash) of XDarwin.
It might also be a file permission problem with the sockets for local
connections.
You can try to clean that up with <tt style="white-space: nowrap;">rm -rf /tmp/.X11-unix</tt>.
Restarting the computer also helps in most cases (Mac OS X
automatically cleans up /tmp when it boots, and the network stack is
reset).
</p>
      <pre>Xlib: connection to ":0.0" refused by server
Xlib: Client is not authorized to connect to Server</pre>
      <p>
Class: Fatal.
The client programs can't connect to the display server (XDarwin)
because they use bogus authentication data.
This can be caused by some VNC installations,
by running XDarwin through sudo,
and probably some other freak accidents.
The usual fix is to delete the .Xauthority file (which stores the
authentication data) in your home directory and re-create an empty
file:
</p>
      <pre>cd
rm .Xauthority
touch .Xauthority</pre>
      <p>
Another common cause for XFree86 startup failures is an incorrect
<tt style="white-space: nowrap;">.xinitrc</tt> file.
What happens is that the <tt style="white-space: nowrap;">.xinitrc</tt> is run and for some
reason terminates almost immediately.
<tt style="white-space: nowrap;">xinit</tt> interprets this as "the user's session has ended"
and kills XDarwin.
See the <a href="#run-xfree86.xinitrc">.xinitrc
section</a> for more details.
Remember to set up the PATH and to have one long-lived program that is
not started in the background.
It is a good idea to add <tt style="white-space: nowrap;">exec xterm</tt> as a fallback when
your window manager or similar can't be found.
</p>
    
    <h3><a name="trouble.black">7.2 Black icons in the GNOME panel or in the
menu of a GNOME application</a></h3>
      
      <p>
A common problem is that icons or other images are displayed as black
rectangles or black outlines.
Ultimately, this is caused by limitations in the operating system
kernel.
The problem has been reported to Apple, but so far they seem unwilling
to fix it; see the filed <a href="http://www.opensource.apple.com/bugs/X/Kernel/2691632.html">Darwin
bug report</a> for details.
</p>
      <p>
The current situation is that the MIT-SHM extension of the X11
protocol is practically unusable on Darwin and Mac OS X.
There are two ways to turn the protocol extension off: in the server
or in the clients.
The XFree86 servers installed by Fink (i.e. the xfree86-server and
xfree86-rootless packages) have it turned off.
The GIMP and the GNOME panel have been inoculated as well.
If you experience black icons in another application, start that
application with the <tt style="white-space: nowrap;">--no-xshm</tt> command line option.
</p>
    
    <h3><a name="trouble.keyboard">7.3 The keyboard doesn't work in XFree86</a></h3>
      
      <p>
This is a known problem that so far seems to affect only portables
(PowerBook, iBook).
To work around this, the "Load from file" keymapping option was
implemented.
Nowadays it has become the default because the old method (reading the
mapping from the kernel) stopped working with Mac OS X 10.1.
If you haven't enabled the option already, you can do so in the
XDarwin preferences dialog.
Check the "Load from file" checkbox and select the keymapping file to
load.
After restarting XDarwin, your keyboard should mostly work (see
below).
</p>
      <p>
If you're starting XFree86 from the command line, you can pass the
name of the keymapping file to load as an option, as in:
</p>
      <pre>startx -- -quartz -keymap USA.keymapping</pre>
    
    <h3><a name="trouble.delete-key">7.4 The Backspace key doesn't work</a></h3>
      
      <p>
This can happen when you use the "Load keymapping from file" option
described above.
The mapping files describe the backspace key as "Delete", not as
"Backspace".
You can correct that by putting the following line in your .xinitrc
file:
</p>
      <pre>xmodmap -e "keycode 59 = BackSpace"</pre>
      <p>
If I remember correctly, XDarwin 1.0a2 and later have code that
correctly maps the Backspace key automatically.
</p>
    
    <h3><a name="trouble.locale">7.5 "Warning: locale not supported by C library"</a></h3>
      
      <p>
These messages are quite common, but harmless.
It just means what it says - internationalization is not supported
through the standard C library, the program will use the default
English messages, date formats, and so on.
There are several ways to deal with this:
</p>
      <ul>
        <li>
          <p>
Just ignore the messages.
</p>
        </li>
        <li>
          <p>
Get rid of the messages by unsetting the environment variable LANG.
Note that this will also turn internationalization off in programs
that actually support it (via gettext/libintl).
Example for .xinitrc:
</p>
          <pre>unset LANG</pre>
          <p>
Example for .cshrc:
</p>
          <pre>unsetenv LANG</pre>
        </li>
        <li>
          <p>
(10.1 only) Use the <tt style="white-space: nowrap;">libxpg4</tt> Fink package.
It builds a small library that contains working locale functions and
arranges that it is loaded before the system libraries (using the
DYLD_INSERT_LIBRARIES environment variable).
You may have to set the LANG environment variable to a fully qualified
value, e.g. <tt style="white-space: nowrap;">de_DE.ISO_8859-1</tt> instead of <tt style="white-space: nowrap;">de</tt>
or <tt style="white-space: nowrap;">de_DE</tt>.
</p>
        </li>
        <li>
          <p>
Ask Apple to include proper locale support in a future version of Mac
OS X.
</p>
        </li>
      </ul>
    
  <h2><a name="tips">8 Usage Tips</a></h2>
    
    
    <h3><a name="tips.terminal-app">8.1 Launching X11 apps from Terminal.app</a></h3>
      
      <p>
To launch X11 applications from a Terminal.app window, you must set
the environment variable "DISPLAY".
This variable tells the applications where to find the X11 window
server.
In the default setup - XDarwin runs on the same machine, your shell is
tcsh - you can set the variable as follows:
</p>
      <pre>setenv DISPLAY :0.0</pre>
      <p>
A nice setup is to have XDarwin.app started when you log in (settable
in the Login panel of the System Preferences) and add the following to
your .cshrc:
</p>
      <pre>if (! $?DISPLAY) then
  setenv DISPLAY :0.0
endif</pre>
      <p>
This sets DISPLAY automatically in every shell.
It doesn't override the current value when DISPLAY is already set,
though.
This way you can still run X11 applications remotely or through ssh
with X11 tunneling.
</p>
    
    <h3><a name="tips.open">8.2 Launching Aqua apps from an xterm</a></h3>
      
      <p>
One way to launch Aqua applications from an xterm (or any other shell,
actually) is the <tt style="white-space: nowrap;">open</tt> command.
Some examples:
</p>
      <pre>open /Applications/TextEdit.app
open SomeDocument.rtf
open -a /Applications/TextEdit.app index.html</pre>
      <p>
The second example opens the document in the application that is
associated with it, the third example explicitly gives an application
to use.
</p>
    
    <h3><a name="tips.copy-n-paste">8.3 Copy and Paste</a></h3>
      
      <p>
Copy and Paste generally works between the Aqua and X11 environments.
There are still some bugs.
Emacs is reported to be picky about the current selection.
Copy and paste from Classic to X11 doesn't work.
</p>
      <p>
Anyway, the trick is to use the respective methods of the environment
you're in.
To transfer text from Aqua to X11, use Cmd-C in Aqua, then bring the
destination window to the front and use the "middle mouse button", i.e. Option-click
on a single-button mouse (this can be configured 
under XDarwin's Preferences), to paste.
To transfer text from X11 to Aqua, simply select the text with the
mouse in X11, then use Cmd-V in Aqua to paste it.
</p>
      <p>
The X11 system actually has several separate clipboards (called "cut
buffers" in X11 speak), and some applications have weird views which
one should be used.
In particular, pasting into GNU Emacs or XEmacs sometimes doesn't work
because of this.
The program <tt style="white-space: nowrap;">autocutsel</tt> can help here; it automatically
synchronizes the two main cut buffers.
To run it, install the autocutsel Fink package and add the following
line to your .xinitrc:
</p>
      <pre>autocutsel &amp;</pre>
      <p>
(Make sure it's <b>before</b> the line that exec's the window
manager and never returns! Don't just add it at the end, it won't
be executed.)
</p>
      <p>If you are using Apple's X11, then you can use Command-C or Edit-&gt;Copy, as 
usual for Mac apps, to copy text to the clipboard.  However, pasting 
from the clipboard to Apple X11 via Command-V doesn't work yet.</p>
    
  <hr><h2>Copyright Notice</h2><p>Copyright (c) 2001 Christoph Pfisterer,
Copyright (c) 2001-2004 The Fink Project.
You may distribute this document in print for private purposes,
provided the document and this copyright notice remain complete and
unmodified. Any commercial reproduction and any online publication
requires the explicit consent of the author.</p><hr><p>Generated from <i>$Fink: x11.fr.xml,v 1.4 2004/04/08 08:01:50 michga Exp $</i></p></body></html>
